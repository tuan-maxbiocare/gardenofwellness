{% comment %}
  Product Star Showcase - 3 Columns Section
{% endcomment %}

{%- liquid
  assign heading = section.settings
  assign layout = section.settings
  assign media = section.settings
  assign product = section.settings
  assign content = section.settings
  
  capture styles
    echo '--section-padding-top:' | append: section.settings.padding_top | append: 'px;'
    echo '--section-padding-bottom:' | append: section.settings.padding_bottom | append: 'px;'
    echo '--section-padding-left:' | append: section.settings.padding_left | append: 'px;'
    echo '--section-padding-right:' | append: section.settings.padding_right | append: 'px;'
    
    echo '--section-padding-top-mobile:' | append: section.settings.padding_top_mobile | append: 'px;'
    echo '--section-padding-bottom-mobile:' | append: section.settings.padding_bottom_mobile | append: 'px;'
    echo '--section-padding-left-mobile:' | append: section.settings.padding_left_mobile | append: 'px;'
    echo '--section-padding-right-mobile:' | append: section.settings.padding_right_mobile | append: 'px;'
    
    echo '--product-bg-color:' | append: section.settings.product_bg | default: '#f9f9f9' | append: ';'
  endcapture
-%}

<section
  class="product-star product-star-showcase section section--{{ section.settings.section_width }}"
  style="{{ styles }}"
  {{ section.shopify_attributes }}
>
  {%- if heading.heading_italic != blank or heading.heading_regular != blank -%}
    <div class="product-star__main-heading" style="
      text-align: {{ heading.heading_alignment }};
      margin: {{ heading.heading_margin_top }}px 0 {{ heading.heading_margin_bottom }}px;
      padding: 0 {{ heading.heading_padding_right }}px 0 {{ heading.heading_padding_left }}px;
    ">
      <h2 class="product-star__heading-title" style="
        font-size: {{ heading.heading_font_size }}px;
        color: {{ heading.heading_color }};
        line-height: {{ heading.heading_line_height }};
        letter-spacing: {{ heading.heading_letter_spacing }}px;
        font-weight: {{ heading.heading_font_weight }};
        margin: 0;
        text-transform: uppercase;
      ">
        {%- if heading.heading_italic != blank -%}
          <span class="italic-text" style="font-style: italic;">{{ heading.heading_italic }}</span>
        {%- endif -%}
        {%- if heading.heading_regular != blank -%}
          {{ heading.heading_regular }}
        {%- endif -%}
      </h2>
    </div>
  {%- endif -%}

  <div class="product-star__wrapper" style="
    max-width: {{ layout.max_width | default: '1440px' }};
    border-radius: {{ layout.section_border_radius }}px;
    overflow: hidden;
  ">
    {% assign media_bg = 'transparent' %}
    {% if media.media_type == 'image' and media.lifestyle_image == blank %}
    {% assign media_bg = '#f5f5f5' %}
    {% endif %}

    <div class="product-star__media" style="
      background: {{ media_bg }};
      border-top-left-radius: {{ layout.section_border_radius }}px;
      border-bottom-left-radius: {{ layout.section_border_radius }}px;
      overflow: hidden;
    ">
      {%- if media.media_type == 'video' and media.video != blank -%}
        <div class="product-star__video-wrapper">
          {{ media.video | video_tag: 
            autoplay: media.autoplay,
            muted: true,
            loop: media.loop_video,
            playsinline: true,
            controls: true,
            class: 'product-star__video'
          }}
        </div>
      {%- elsif media.lifestyle_image != blank -%}
        <div class="product-star__image-wrapper">
          {{ media.lifestyle_image | image_url: width: 1500 | image_tag:
            loading: 'lazy',
            widths: '300, 600, 800, 1000, 1200, 1500',
            sizes: '(min-width: 990px) 33vw, 100vw',
            class: 'product-star__image',
            alt: media.lifestyle_image.alt | escape
          }}
        </div>
      {%- else -%}
        <div class="product-star__placeholder">
          {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
        </div>
      {%- endif -%}
    </div>

    <div class="product-star__product" style="background: {{ product.product_bg | default: '#f9f9f9' }};">
      {%- if product.product != blank -%}
        {%- assign current_product = product.product -%}
        <script type="application/ld+json">{{ current_product | structured_data }}</script>
        
        <div class="product-star__card-wrapper">
          <div class="product-star__card-track">
            <a href="{{ current_product.url }}" class="product-star__card">
              <div class="product-star__card-image">
                {%- if current_product.featured_image -%}
                  {{ current_product.featured_image | image_url: width: 800 | image_tag:
                      loading: 'lazy',
                      widths: '200, 300, 400, 600, 800',
                      sizes: '(min-width: 990px) 400px, 80px',
                      class: 'product-star__card-img',
                      alt: current_product.featured_image.alt | escape
                  }}
                {%- else -%}
                  {{ 'product-1' | placeholder_svg_tag: 'placeholder-svg' }}
                {%- endif -%}
              </div>
              <div class="product-star__card-info">
                <h3 class="product-star__card-title">{{ current_product.title }}</h3>
                <div class="product-star__card-price">
                  <span class="price-current">{{ current_product.price | money }}</span>
                  {%- if current_product.compare_at_price > current_product.price -%}
                    <span class="price-compare">{{ current_product.compare_at_price | money }}</span>
                  {%- endif -%}
                </div>
              </div>
            </a>
          </div>
        </div>
      {%- else -%}
        <div class="product-star__card-wrapper">
          <div class="product-star__card-track">
            <a href="#" class="product-star__card">
              <div class="product-star__card-image">{{ 'product-1' | placeholder_svg_tag: 'placeholder-svg' }}</div>
              <div class="product-star__card-info">
                <h3 class="product-star__card-title">Argan Milk Serum</h3>
                <div class="product-star__card-price">
                  <span class="price-current">$90.00</span>
                  <span class="price-compare">$120.00</span>
                </div>
              </div>
            </a>
          </div>
        </div>
      {%- endif -%}
    </div>

    <div class="product-star__content" style="
      background: {{ content.content_bg | default: '#5f6b54' }};
      color: {{ content.text_color | default: '#ffffff' }};
      border-top-right-radius: {{ layout.section_border_radius }}px;
      border-bottom-right-radius: {{ layout.section_border_radius }}px;
      overflow: hidden;
    ">
      <div class="product-star__content-wrapper">
        <div class="product-star__features">
          {%- for block in section.blocks -%}
            {%- assign benefit = block.settings -%}
            <div class="product-star__feature" {{ block.shopify_attributes }}>
              <div class="product-star__icon">
                <div class="benefit-icon" style="
                  background-color: {{ benefit.icon_bg_color }};
                  color: {{ benefit.icon_color }};
                  width: 48px;
                  height: 48px;
                  border-radius: 50%;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  font-size: 24px;
                ">
                  <i class="ph ph-{{ benefit.icon }}"></i>
                </div>
              </div>
              <div class="product-star__text">
                {%- if benefit.title != blank -%}
                  <h4 class="product-star__feature-title" style="
                    margin: 0 0 8px;
                    font-size: 18px;
                    font-weight: 600;
                    line-height: 1.3;
                    text-transform: uppercase;
                    letter-spacing: 0.5px;
                  ">{{ benefit.title }}</h4>
                {%- endif -%}
                {%- if benefit.description != blank -%}
                  <p class="product-star__feature-text" style="
                    margin: 0;
                    opacity: 0.85;
                    font-size: 15px;
                    line-height: 1.6;
                    word-wrap: break-word;
                    overflow-wrap: break-word;
                  ">{{ benefit.description }}</p>
                {%- endif -%}
              </div>
            </div>
            {%- unless forloop.last -%}
              <div class="product-star__divider" style="
                height: 1px;
                background: rgba(255, 255, 255, 0.3) !important;
                margin: 24px 0 !important;
                width: 100% !important;
                display: block !important;
                opacity: 1 !important;
                border: none !important;
              "></div>
            {%- endunless -%}
          {%- endfor -%}
        </div>
        <div class="custom-scrollbar">
          <div class="custom-scrollbar-track">
            <div class="custom-scrollbar-thumb"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  .product-star.product-star-showcase {
    border-radius: {{ section.settings.section_border_radius }}px;
    overflow: hidden;
    padding-top: var(--section-padding-top);
    padding-bottom: var(--section-padding-bottom);
    padding-left: var(--section-padding-left);
    padding-right: var(--section-padding-right);
  }

  @media (max-width: 768px) {
    .product-star.product-star-showcase {
      padding-top: var(--section-padding-top-mobile);
      padding-bottom: var(--section-padding-bottom-mobile);
      padding-left: var(--section-padding-left-mobile);
      padding-right: var(--section-padding-right-mobile);
    }
  }

  .product-star__wrapper {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 0;
    margin: 0 auto;
    height: 100%;
  }

  .section--page-width .product-star__wrapper {
    max-width: {{ section.settings.max_width | default: '1440px' }};
  }

  .section--full-width .product-star__wrapper {
    max-width: 100%;
    margin: 0;
  }

  .product-star__media,
  .product-star__product,
  .product-star__content {
    height: 100%;
    min-height: 600px;
    position: relative;
  }

  .product-star__media {
    position: relative;
    overflow: hidden;
  }

  .product-star__video-wrapper,
  .product-star__image-wrapper,
  .product-star__placeholder {
    width: 100%;
    height: 100%;
    position: relative;
  }

  .product-star__video,
  .product-star__image,
  .product-star__card-img,
  .product-star__placeholder .placeholder-svg {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .product-star__placeholder {
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .product-star__placeholder .placeholder-svg {
    width: 80%;
    height: 80%;
    fill: #ddd;
  }

  .product-star__product {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 40px;
  }

  /* Desktop card styling */
  .product-star__card {
    display: block;
    width: 100%;
    max-width: 400px;
    text-decoration: none;
    color: inherit;
    overflow: hidden;
  }

  .product-star__card-img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  transform: scale(1);
  transition: transform 0.45s cubic-bezier(0.4, 0, 0.2, 1);
  will-change: transform;
}

.product-star__card:hover .product-star__card-img {
  transform: scale(1.05);
}


  .product-star__card-info {
    padding: 24px;
    text-align: center;
  }

  .product-star__card-title {
    font-size: 22px;
    font-weight: 600;
    margin: 0 0 16px;
    color: #000000;
    line-height: 1.3;
  }

  .product-star__card-price {
    font-size: 24px;
    font-weight: 700;
    color: #000000;
    margin: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
  }
  .price-compare {
    font-size: 18px;
    color: #999;
    text-decoration: line-through;
    font-weight: 400;
  }

  .product-star__content {
    display: flex;
    flex-direction: column;
    height: 100%;
    position: relative;
  }

  .product-star__content-wrapper {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    padding: 50px 40px 50px 50px;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  .product-star__features {
    display: flex;
    flex-direction: column;
    flex: 1;
    overflow-y: auto;
    padding-right: 16px;
    position: relative;
  }
  .product-star__features::-webkit-scrollbar {
    display: none;
    width: 0;
  }
  .product-star__features {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .custom-scrollbar {
    position: absolute;
    top: 50px;
    right: 20px;
    bottom: 50px;
    width: 2px;
    background: transparent;
    z-index: 10;
  }
  .custom-scrollbar-track {
    position: relative;
    width: 100%;
    height: 100%;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 2px;
    overflow: hidden;
  }
  .custom-scrollbar-thumb {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 50px;
    background: rgba(255, 255, 255, 0.5);
    border-radius: 2px;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  .custom-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.7);
  }

  .product-star__feature {
    display: flex;
    gap: 20px;
    align-items: flex-start;
    flex-shrink: 0;
    position: relative;
  }
  .product-star__icon {
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .product-star__text {
    flex: 1;
    min-width: 0;
  }

  /* Video Custom Controls */
  .product-star__video::-webkit-media-controls-panel {
    background: linear-gradient(to top, rgba(0,0,0,0.7) 0%, transparent 100%);
    opacity: 0;
    transition: opacity 0.3s ease;
  }
  .product-star__video-wrapper:hover .product-star__video::-webkit-media-controls-panel {
    opacity: 1;
  }
  .product-star__video::-webkit-media-controls-timeline {
    background-color: rgba(255, 255, 255, 0.3);
    border-radius: 2px;
    height: 4px;
  }
  .product-star__video::-webkit-media-controls-timeline::-webkit-slider-thumb {
    background-color: white;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    cursor: pointer;
  }
  .product-star__video::-webkit-media-controls-timeline::-webkit-slider-runnable-track {
    background: linear-gradient(to right, white var(--progress), transparent var(--progress));
    height: 4px;
  }
  .product-star__video::-webkit-media-controls-volume-slider {
    background-color: rgba(255, 255, 255, 0.3);
    border-radius: 2px;
    height: 4px;
  }
  .product-star__video::-webkit-media-controls-volume-slider::-webkit-slider-thumb {
    background-color: white;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    cursor: pointer;
  }
  .product-star__video::-webkit-media-controls-play-button,
  .product-star__video::-webkit-media-controls-mute-button,
  .product-star__video::-webkit-media-controls-current-time-display,
  .product-star__video::-webkit-media-controls-time-remaining-display,
  .product-star__video::-webkit-media-controls-fullscreen-button {
    color: white !important;
    filter: none !important;
  }
  .product-star__video::-moz-range-track {
    background-color: rgba(255, 255, 255, 0.3);
    height: 4px;
    border-radius: 2px;
  }
  .product-star__video::-moz-range-thumb {
    background-color: white;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    border: none;
    cursor: pointer;
  }
  .product-star__video::-moz-range-progress {
    background-color: white;
    height: 4px;
    border-radius: 2px;
  }
  .product-star__video::-moz-media-controls-panel {
    background: linear-gradient(to top, rgba(0,0,0,0.7) 0%, transparent 100%);
    opacity: 0;
    transition: opacity 0.3s ease;
  }
  .product-star__video-wrapper:hover .product-star__video::-moz-media-controls-panel {
    opacity: 1;
  }
  .product-star__video::-moz-media-controls-play-button,
  .product-star__video::-moz-media-controls-mute-button,
  .product-star__video::-moz-media-controls-fullscreen-button {
    filter: invert(1);
    opacity: 0.9;
  }

  /* Responsive */
  @media (max-width: 1200px) {
    .product-star__wrapper { max-width: 100%; }
    .product-star__media,
    .product-star__product,
    .product-star__content { min-height: 500px; }
    .product-star__content-wrapper { padding: 40px 35px 40px 40px; }
    .custom-scrollbar { top: 40px; right: 15px; bottom: 40px; }
    .product-star__card-image { height: 300px; }
    .product-star__card-title { font-size: 20px; }
    .product-star__card-price { font-size: 22px; }
  }

  /* MOBILE RESPONSIVE - FIX KHÔNG TRƯỢT NGANG */
/* MOBILE RESPONSIVE - FIX KHÔNG TRƯỢT NGANG */
@media (max-width: 990px) {
  .product-star__wrapper {
    display: block;
    border-radius: 0 !important;
    overflow: hidden;
  }

  /* Xóa border radius trên mobile */
  .product-star__media,
  .product-star__product,
  .product-star__content {
    border-radius: 0 !important;
  }

  /* Media section - full content - GIỮ NGUYÊN HEIGHT CHO VIDEO */
  .product-star__media {
    height: auto;
    min-height: 600px; /* GIỮ NGUYÊN height như desktop */
    position: relative;
  }

  /* VIDEO WRAPPER - GIỮ NGUYÊN HEIGHT 100% */
  .product-star__video-wrapper,
  .product-star__image-wrapper {
    height: 100% !important; /* QUAN TRỌNG: height 100% thay vì fixed height */
    position: relative;
  }

  .product-star__video,
  .product-star__image {
    height: 100% !important; /* QUAN TRỌNG: video full height */
    object-fit: cover;
    display: block;
  }

  /* Product section - FIX: Xóa wrapper scroll ngang */
  .product-star__product {
    order: 2;
    min-height: 0;
    height: auto;
    padding: 20px 16px;
    position: relative;
  }

  /* XÓA HOÀN TOÀN wrapper và track cho scroll ngang */
  .product-star__card-wrapper,
  .product-star__card-track {
    display: block;
    width: 100%;
    max-width: 100%;
    overflow: visible;
    padding: 0;
    margin: 0;
    scroll-snap-type: none;
  }

  /* Card item mobile - HIỂN THỊ BÌNH THƯỜNG, KHÔNG SCROLL NGANG */
  .product-star__card {
    min-width: 100%;
    width: 100%;
    padding: 16px;
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: 16px;
    text-align: left;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    background: white;
    height: auto;
    box-sizing: border-box;
    max-width: none;
    margin: 0 auto;
  }

  .product-star__card:hover {
    transform: none !important;
  }

  /* Hình ảnh nhỏ, vuông */
  .product-star__card-image {
    width: 80px !important;
    height: 80px !important;
    min-width: 80px !important;
    min-height: 80px !important;
    margin-bottom: 0 !important;
    border-radius: 6px;
    flex-shrink: 0;
    overflow: hidden;
  }

  .product-star__card-image img,
  .product-star__card-image svg {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  /* Info bên cạnh hình ảnh */
  .product-star__card-info {
    padding: 0 !important;
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    min-width: 0;
    text-align: left;
  }

  /* Title */
  .product-star__card-title {
    font-size: 16px !important;
    margin: 0 0 8px 0 !important;
    font-weight: 600;
    line-height: 1.3;
    color: #222;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* PRICE NẰM NGANG */
  .product-star__card-price {
    font-size: 14px !important;
    display: flex !important;
    flex-direction: row !important;
    align-items: center !important;
    gap: 8px !important;
    margin-top: 0 !important;
    text-align: left;
    flex-wrap: wrap;
    justify-content: flex-start;
  }

  .product-star__card-price .price-current {
    font-size: 16px !important;
    font-weight: 700;
    color: #222;
  }

  .product-star__card-price .price-compare {
    font-size: 14px !important;
    color: #999;
    text-decoration: line-through;
  }

  /* Content section - full content */
  .product-star__content {
    order: 3;
    min-height: 0;
    height: auto;
    position: relative;
  }

  .product-star__content-wrapper {
    position: relative;
    padding: 40px 25px;
    display: block;
  }

  .product-star__features {
    overflow-y: visible;
    padding-right: 0;
  }

  .custom-scrollbar {
    display: none;
  }

  .product-star__feature {
    gap: 16px;
    padding: 16px 0;
  }

  .benefit-icon {
    width: 40px;
    height: 40px;
    font-size: 20px;
    flex-shrink: 0;
  }

  .product-star__feature-title {
    font-size: 16px !important;
    margin-bottom: 6px !important;
  }

  .product-star__feature-text {
    font-size: 14px !important;
    line-height: 1.5 !important;
  }

  .product-star__divider {
    margin: 16px 0 !important;
  }
}

@media (max-width: 768px) {
  /* VIDEO - GIỮ NGUYÊN HEIGHT */
  .product-star__video-wrapper,
  .product-star__image-wrapper {
    height: 100% !important; /* Vẫn giữ 100% */
  }

  .product-star__video,
  .product-star__image {
    height: 100% !important; /* Vẫn giữ 100% */
  }

  .product-star__product {
    padding: 16px 12px;
  }

  .product-star__card {
    padding: 12px;
    gap: 12px;
  }

  .product-star__card-image {
    width: 70px !important;
    height: 70px !important;
    min-width: 70px !important;
    min-height: 70px !important;
    border-radius: 5px;
  }

  .product-star__card-title {
    font-size: 15px !important;
  }

  .product-star__card-price {
    font-size: 13px !important;
  }

  .product-star__card-price .price-current {
    font-size: 15px !important;
  }

  .product-star__card-price .price-compare {
    font-size: 13px !important;
  }

  .product-star__content-wrapper {
    padding: 35px 20px;
  }

  .product-star__feature {
    gap: 14px;
    padding: 14px 0;
  }

  .benefit-icon {
    width: 36px;
    height: 36px;
    font-size: 18px;
  }

  .product-star__feature-title {
    font-size: 15px !important;
  }

  .product-star__feature-text {
    font-size: 13px !important;
  }
}

@media (max-width: 480px) {
  /* VIDEO - VẪN GIỮ NGUYÊN HEIGHT */
  .product-star__video-wrapper,
  .product-star__image-wrapper {
    height: 100% !important; /* Vẫn giữ 100% */
  }

  .product-star__video,
  .product-star__image {
    height: 100% !important; /* Vẫn giữ 100% */
  }

  .product-star__product {
    padding: 12px 8px;
  }

  .product-star__card {
    padding: 10px;
    gap: 10px;
    border-radius: 6px;
  }

  .product-star__card-image {
    width: 60px !important;
    height: 60px !important;
    min-width: 60px !important;
    min-height: 60px !important;
    border-radius: 4px;
  }

  .product-star__card-title {
    font-size: 14px !important;
    margin: 0 0 6px 0 !important;
  }

  .product-star__card-price {
    font-size: 12px !important;
    gap: 6px !important;
  }

  .product-star__card-price .price-current {
    font-size: 14px !important;
  }

  .product-star__card-price .price-compare {
    font-size: 12px !important;
  }

  .product-star__content-wrapper {
    padding: 30px 16px;
  }

  .product-star__feature {
    gap: 12px;
    padding: 12px 0;
  }

  .benefit-icon {
    width: 32px;
    height: 32px;
    font-size: 16px;
  }

  .product-star__feature-title {
    font-size: 14px !important;
  }

  .product-star__feature-text {
    font-size: 12px !important;
  }

  .product-star__divider {
    margin: 12px 0 !important;
  }

  .product-star__video::-webkit-media-controls-panel,
  .product-star__video::-moz-media-controls-panel {
    opacity: 1;
  }
}
/* FIX: Divider không hiện trên desktop do scroll container */
.product-star__divider {
  min-height: 1px;
  height: 1px;
  transform: translateZ(0);
  backface-visibility: hidden;
}

</style>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const videos = document.querySelectorAll('.product-star__video');
  videos.forEach(video => {
    video.setAttribute('playsinline', '');
    video.setAttribute('webkit-playsinline', '');
    if (video.hasAttribute('autoplay')) {
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) video.play().catch(e => console.log('Autoplay prevented:', e));
          else video.pause();
        });
      }, { threshold: 0.5 });
      observer.observe(video);
    }
  });

  const initScrollbar = () => {
    const features = document.querySelector('.product-star__features');
    const scrollbar = document.querySelector('.custom-scrollbar');
    const thumb = document.querySelector('.custom-scrollbar-thumb');
    const track = document.querySelector('.custom-scrollbar-track');
    if (!features || !scrollbar || window.innerWidth < 990) {
      if (scrollbar) scrollbar.style.display = 'none';
      return;
    }
    scrollbar.style.display = 'block';
    const updateScrollbar = () => {
      const containerH = features.clientHeight;
      const contentH = features.scrollHeight;
      const scrollTop = features.scrollTop;
      const thumbHeight = Math.max((containerH / contentH) * 100, 10);
      const maxScroll = contentH - containerH;
      const thumbPosition = maxScroll > 0 ? (scrollTop / maxScroll) * (100 - thumbHeight) : 0;
      thumb.style.height = `${thumbHeight}%`;
      thumb.style.top = `${thumbPosition}%`;
    };
    features.addEventListener('scroll', updateScrollbar);
    window.addEventListener('resize', updateScrollbar);
    let isDragging = false;
    thumb.addEventListener('mousedown', (e) => {
      isDragging = true;
      const trackRect = track.getBoundingClientRect();
      const thumbHeight = thumb.offsetHeight;
      const trackHeight = track.offsetHeight;
      const mouseMove = (e) => {
        if (!isDragging) return;
        const mouseY = e.clientY - trackRect.top;
        const newThumbPos = Math.max(0, Math.min(mouseY - thumbHeight / 2, trackHeight - thumbHeight));
        const thumbPosPercent = (newThumbPos / (trackHeight - thumbHeight)) * 100;
        const contentH = features.scrollHeight;
        const containerH = features.clientHeight;
        const maxScroll = contentH - containerH;
        features.scrollTop = (thumbPosPercent / 100) * maxScroll;
      };
      const mouseUp = () => {
        isDragging = false;
        document.removeEventListener('mousemove', mouseMove);
        document.removeEventListener('mouseup', mouseUp);
      };
      document.addEventListener('mousemove', mouseMove);
      document.addEventListener('mouseup', mouseUp);
      e.preventDefault();
    });
    track.addEventListener('click', (e) => {
      const trackRect = track.getBoundingClientRect();
      const clickY = e.clientY - trackRect.top;
      const trackHeight = trackRect.height;
      const contentH = features.scrollHeight;
      const containerH = features.clientHeight;
      const maxScroll = contentH - containerH;
      const clickPercent = clickY / trackHeight;
      features.scrollTop = clickPercent * maxScroll;
    });
    updateScrollbar();
    const contentSection = document.querySelector('.product-star__content');
    if (contentSection) {
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            features.scrollTop = 0;
            updateScrollbar();
          }
        });
      }, { threshold: 0.1 });
      observer.observe(contentSection);
    }
  };
  initScrollbar();
  let resizeTimeout;
  window.addEventListener('resize', () => {
    clearTimeout(resizeTimeout);
    resizeTimeout = setTimeout(() => initScrollbar(), 250);
  });
});
</script>

{% schema %}
{
  "name": "Product Star Showcase",
  "tag": "section",
  "class": "section-product-star",
  "settings": [
    {
      "type": "select",
      "id": "section_width",
      "label": "Section width",
      "options": [
        { "value": "page-width", "label": "Page width" },
        { "value": "full-width", "label": "Full width" }
      ],
      "default": "page-width"
    },
    {
      "type": "header",
      "content": "Section Padding"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Padding top (desktop)",
      "min": 0,
      "max": 160,
      "step": 8,
      "default": 80
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "Padding bottom (desktop)",
      "min": 0,
      "max": 160,
      "step": 8,
      "default": 80
    },
    {
      "type": "range",
      "id": "padding_left",
      "label": "Padding left (desktop)",
      "min": 0,
      "max": 160,
      "step": 8,
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_right",
      "label": "Padding right (desktop)",
      "min": 0,
      "max": 160,
      "step": 8,
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_top_mobile",
      "label": "Padding top (mobile)",
      "min": 0,
      "max": 120,
      "step": 8,
      "default": 48
    },
    {
      "type": "range",
      "id": "padding_bottom_mobile",
      "label": "Padding bottom (mobile)",
      "min": 0,
      "max": 120,
      "step": 8,
      "default": 48
    },
    {
      "type": "range",
      "id": "padding_left_mobile",
      "label": "Padding left (mobile)",
      "min": 0,
      "max": 120,
      "step": 8,
      "default": 16
    },
    {
      "type": "range",
      "id": "padding_right_mobile",
      "label": "Padding right (mobile)",
      "min": 0,
      "max": 120,
      "step": 8,
      "default": 16
    },
    {
      "type": "range",
      "id": "section_border_radius",
      "label": "Border Radius",
      "min": 0,
      "max": 100,
      "step": 2,
      "default": 0,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Main Heading"
    },
    {
      "type": "text",
      "id": "heading_italic",
      "label": "Heading (Italic Part)",
      "default": "Product star"
    },
    {
      "type": "text",
      "id": "heading_regular",
      "label": "Heading (Regular Part)",
      "default": "of this season"
    },
    {
      "type": "select",
      "id": "heading_alignment",
      "label": "Alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "center"
    },
    {
      "type": "range",
      "id": "heading_font_size",
      "label": "Font Size",
      "min": 20,
      "max": 80,
      "step": 1,
      "default": 48,
      "unit": "px"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Color",
      "default": "#333333"
    },
    {
      "type": "range",
      "id": "heading_font_weight",
      "label": "Font Weight",
      "min": 100,
      "max": 900,
      "step": 100,
      "default": 700
    },
    {
      "type": "range",
      "id": "heading_line_height",
      "label": "Line Height",
      "min": 0.8,
      "max": 2.0,
      "step": 0.1,
      "default": 1.1
    },
    {
      "type": "range",
      "id": "heading_letter_spacing",
      "label": "Letter Spacing",
      "min": -2,
      "max": 10,
      "step": 0.5,
      "default": 1,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "heading_margin_top",
      "label": "Margin Top",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 0,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "heading_margin_bottom",
      "label": "Margin Bottom",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 60,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "heading_padding_left",
      "label": "Padding Left",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 20,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "heading_padding_right",
      "label": "Padding Right",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 20,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "text",
      "id": "max_width",
      "label": "Maximum Width",
      "default": "1440px"
    },
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background Color",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Left Media"
    },
    {
      "type": "select",
      "id": "media_type",
      "label": "Media Type",
      "options": [
        { "value": "image", "label": "Image" },
        { "value": "video", "label": "Video" }
      ],
      "default": "image"
    },
    {
      "type": "image_picker",
      "id": "lifestyle_image",
      "label": "Lifestyle Image"
    },
    {
      "type": "video",
      "id": "video",
      "label": "Lifestyle Video"
    },
    {
      "type": "checkbox",
      "id": "autoplay",
      "label": "Autoplay Video",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "loop_video",
      "label": "Loop Video",
      "default": true
    },
    {
      "type": "header",
      "content": "Center Product"
    },
    {
      "type": "product",
      "id": "product",
      "label": "Product"
    },
    {
      "type": "color",
      "id": "product_bg",
      "label": "Background",
      "default": "#f9f9f9"
    },
    {
      "type": "header",
      "content": "Right Content"
    },
    {
      "type": "color",
      "id": "content_bg",
      "label": "Background",
      "default": "#5f6b54"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#ffffff"
    }
  ],
  "blocks": [
    {
      "type": "benefit",
      "name": "Benefit",
      "settings": [
        {
          "type": "text",
          "id": "icon",
          "label": "Icon",
          "default": "check-circle",
          "info": "Phosphor icon name"
        },
        {
          "type": "color",
          "id": "icon_bg_color",
          "label": "Icon Background",
          "default": "#f0f0f0"
        },
        {
          "type": "color",
          "id": "icon_color",
          "label": "Icon Color",
          "default": "#000000"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Benefit Title"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Description",
          "default": "Brief description of this product benefit."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Product Star Showcase",
      "category": "Product",
      "settings": {
        "section_width": "page-width",
        "padding_top": 80,
        "padding_bottom": 80,
        "padding_left": 0,
        "padding_right": 0,
        "padding_top_mobile": 48,
        "padding_bottom_mobile": 48,
        "padding_left_mobile": 16,
        "padding_right_mobile": 16,
        "section_border_radius": 0,
        "heading_italic": "Product star",
        "heading_regular": "of this season",
        "heading_alignment": "center",
        "heading_font_size": 48,
        "heading_color": "#333333",
        "heading_font_weight": 700,
        "heading_line_height": 1.1,
        "heading_letter_spacing": 1,
        "heading_margin_top": 0,
        "heading_margin_bottom": 60,
        "heading_padding_left": 20,
        "heading_padding_right": 20,
        "media_type": "image",
        "lifestyle_image": "shopify://shop_images/young-woman-doing-yoga-outside.jpg",
        "product": "active-sports-bra",
        "product_bg": "#f9f9f9",
        "content_bg": "#5f6b54",
        "text_color": "#ffffff",
        "autoplay": true,
        "loop_video": true
      },
      "blocks": [
        {
          "type": "benefit",
          "settings": {
            "icon": "drop",
            "icon_bg_color": "#e8f4f8",
            "icon_color": "#0891b2",
            "title": "Moisture-Wicking",
            "description": "Advanced fabric technology keeps you dry and comfortable during intense workouts."
          }
        },
        {
          "type": "benefit",
          "settings": {
            "icon": "wind",
            "icon_bg_color": "#f0fdf4",
            "icon_color": "#16a34a",
            "title": "Breathable Design",
            "description": "Strategic ventilation zones provide maximum airflow for optimal temperature regulation."
          }
        },
        {
          "type": "benefit",
          "settings": {
            "icon": "arrows-out",
            "icon_bg_color": "#fef3c7",
            "icon_color": "#d97706",
            "title": "4-Way Stretch",
            "description": "Move freely in any direction with premium stretch fabric that maintains its shape."
          }
        },
        {
          "type": "benefit",
          "settings": {
            "icon": "recycle",
            "icon_bg_color": "#f3e8ff",
            "icon_color": "#9333ea",
            "title": "Eco-Friendly",
            "description": "Made from recycled materials without compromising on quality, performance, or style."
          }
        }
      ]
    }
  ]
}
{% endschema %}