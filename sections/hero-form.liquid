<section class="sp-contact-hero">
  <div class="spc-container">
    <div class="spc-hero-grid">
      <div class="spc-hero-media" aria-label="Hero image">
        {% if section.settings.hero_image != blank %}
          {{ section.settings.hero_image | image_url: width: 1800 | image_tag: loading: 'lazy', class: 'spc-hero-img', alt: section.settings.hero_image.alt | escape }}
        {% else %}
          <div class="spc-hero-placeholder">Add hero image</div>
        {% endif %}
      </div>

      <div class="spc-card">
        <div class="spc-card-pad">
          {% if section.settings.kicker != blank %}
            <p class="spc-kicker">{{ section.settings.kicker }}</p>
          {% endif %}
          <h1 class="spc-title">{{ section.settings.heading }}</h1>

          {%- form 'contact', id: 'ContactForm', class: 'spc-form' -%}
            {%- if form.posted_successfully? -%}
              <p class="spc-success">{{ section.settings.success_text }}</p>
            {%- elsif form.errors -%}
              <p class="spc-error">{{ form.errors | default_errors }}</p>
            {%- endif -%}

            <div class="spc-field">
              <label for="ContactFormName">{{ section.settings.label_name }}</label>
              <input
                class="spc-input"
                id="ContactFormName"
                type="text"
                name="contact[name]"
                placeholder="{{ section.settings.ph_name }}"
                autocomplete="name"
                value="{% if form.name %}{{ form.name }}{% endif %}">
            </div>

            <div class="spc-field">
              <label for="ContactFormEmail">
                {{ section.settings.label_email }} <span class="spc-required">*</span>
              </label>
              <input
                class="spc-input"
                id="ContactFormEmail"
                type="email"
                name="contact[email]"
                placeholder="{{ section.settings.ph_email }}"
                autocomplete="email"
                required
                value="{% if form.email %}{{ form.email }}{% endif %}">
            </div>

            <div class="spc-field">
              <label for="ContactFormPhone">{{ section.settings.label_phone }}</label>
              <input
                class="spc-input"
                id="ContactFormPhone"
                type="tel"
                name="contact[phone]"
                placeholder="{{ section.settings.ph_phone }}"
                autocomplete="tel"
                value="{% if form.phone %}{{ form.phone }}{% endif %}">
            </div>

            <div class="spc-field">
              <label for="ContactFormMessage">{{ section.settings.label_message }}</label>
              <textarea
                class="spc-textarea"
                id="ContactFormMessage"
                name="contact[body]"
                placeholder="{{ section.settings.ph_message }}"
                rows="6">{% if form.body %}{{ form.body }}{% endif %}</textarea>
            </div>

            <button class="spc-btn" type="submit">{{ section.settings.button_text }}</button>
          {%- endform -%}
        </div>
      </div>
    </div>
  </div>

  <style>
    /* SECTION WRAP */
    .sp-contact-hero{ padding: {{ section.settings.py }}px 0; }

    /* FULL-WIDTH container + safe side padding */
    .spc-container{
      width: 100%;
      margin: 0;
      padding: 0 ;
    }

    /* GRID: no gap + stretch */
    .spc-hero-grid{
      display: grid;
      grid-template-columns: 1.1fr .9fr;
      gap: 0;
      align-items: stretch;
    }

    /* LEFT MEDIA: height linh động theo form (không set height cố định) */
    .spc-hero-media{
      position: relative;
      overflow: hidden;

      /* QUAN TRỌNG: khung trái phải stretch theo cột */
      align-self: stretch;
      height: auto;
      min-height: 0;

      background: #f3f4f6;
      border: 1px solid #e5e7eb;
      box-shadow: 0 10px 22px rgba(17,24,39,.08);
      border-radius: 22px 0 0 22px;
    }

    /* IMG cover full khung (không dùng aspect-ratio) */
    .spc-hero-img{
      position: absolute;
  top:-5%;   
  inset:-60px 0;          /* dư 60px trên + dưới */
  width:100%;
  height: calc(100% + 120px);
  object-fit:cover;
  display:block;
  will-change: transform;
    }

    .spc-hero-placeholder{
      min-height: 380px;
      display: grid;
      place-items: center;
      color: #6b7280;
      font-size: 14px;
    }

    /* RIGHT CARD */
    .spc-card{
      align-self: stretch;
      background: #fff;
      border: 1px solid #e5e7eb;
      box-shadow: 0 10px 22px rgba(17,24,39,.08);
      border-radius: 0 22px 22px 0;
    }
    .spc-card-pad{ padding: 26px; }

    .spc-kicker{
      font-size: 12px;
      letter-spacing: .14em;
      text-transform: uppercase;
      color: #6b7280;
      margin: 0 0 10px;
    }
    .spc-title{
      font-size: clamp(22px, 2.2vw, 32px);
      margin: 0 0 18px;
      line-height: 1.15;
    }

    .spc-form{ display: grid; gap: 14px; }
    .spc-field label{
      display: block;
      font-size: 13px;
      color: #6b7280;
      margin: 0 0 6px;
    }
    .spc-input, .spc-textarea{
      width: 100%;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      padding: 12px 14px;
      font-size: 15px;
      outline: none;
      background: #fff;
      transition: border-color .15s ease, box-shadow .15s ease;
    }
    .spc-textarea{ min-height: 120px; resize: vertical; }
    .spc-input:focus, .spc-textarea:focus{
      border-color: #c7c9d1;
      box-shadow: 0 0 0 4px rgba(17,24,39,.06);
    }
    .spc-required{ color: #ef4444; margin-left: 4px; font-weight: 600; }

    .spc-btn{
      display: inline-flex;
      align-items: center;
      justify-content: center;
      height: 46px;
      padding: 0 22px;
      border: none;
      border-radius: 999px;
      background: #111;
      color: #fff;
      font-weight: 600;
      cursor: pointer;
      transition: transform .06s ease, background .15s ease;
      width: fit-content;
    }
    .spc-btn:hover{ background: #000; }
    .spc-btn:active{ transform: translateY(1px); }

    .spc-success{ margin: 0 0 10px; color: #16a34a; font-weight: 600; }
    .spc-error{ margin: 0 0 10px; color: #dc2626; }
/* TABLET/MOBILE: full width + no radius */
@media (max-width: 980px){
  .spc-container{ padding: 0; }                 /* full width */
  .spc-hero-grid{ grid-template-columns: 1fr; gap: 0; }

  .spc-hero-media{
    border-radius: 0;                           /* bỏ góc */
    min-height: 280px;                          /* tuỳ bạn */
  }

  .spc-card{
    border-radius: 0;                           /* bỏ góc */
  }
}

/* MOBILE nhỏ: vẫn full width (không padding) */
@media (max-width: 560px){
  .spc-container{ padding: 0; }                 /* bỏ 0 16px */
}

  </style>

  <script>
(() => {
  // Tôn trọng người dùng không muốn motion
  const reduceMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
  if (reduceMotion) return;

  const section = document.currentScript.closest('.sp-contact-hero');
  if (!section) return;

  const img = section.querySelector('.spc-hero-img');
  const media = section.querySelector('.spc-hero-media');
  if (!img || !media) return;

  // Điều chỉnh độ trượt (px). Bạn muốn mạnh hơn thì tăng số này.
  const MAX_SHIFT = 120;

  let ticking = false;

  const clamp01 = (v) => Math.max(0, Math.min(1, v));

  function update() {
    ticking = false;

    const rect = section.getBoundingClientRect();
    const vh = window.innerHeight || document.documentElement.clientHeight;

    // progress 0..1 khi section đi qua viewport
    // 0: section vừa chạm đáy viewport
    // 1: section vừa ra khỏi đỉnh viewport
    const raw = (vh - rect.top) / (vh + rect.height);
    const p = clamp01(raw);

    // map progress -> translateY (từ -MAX/2 đến +MAX/2)
    const y = (p - 0.5) * MAX_SHIFT;

    img.style.transform = `translate3d(0, ${y}px, 0)`;
  }

  function onScroll() {
    if (!ticking) {
      ticking = true;
      requestAnimationFrame(update);
    }
  }

  // chỉ chạy khi section xuất hiện trong viewport (tối ưu)
  let active = false;
  const io = new IntersectionObserver((entries) => {
    active = entries.some(e => e.isIntersecting);
    if (active) update();
  }, { threshold: 0 });

  io.observe(section);

  window.addEventListener('scroll', () => { if (active) onScroll(); }, { passive: true });
  window.addEventListener('resize', () => { if (active) onScroll(); });

  // chạy lần đầu
  update();
})();
</script>

</section>

{% schema %}
{
  "name": "Contact - Hero + Form",
  "settings": [
    { "type": "range", "id": "py", "label": "Padding vertical", "min": 0, "max": 80, "step": 2, "default": 38 },

    { "type": "image_picker", "id": "hero_image", "label": "Hero image" },
    { "type": "text", "id": "kicker", "label": "Kicker", "default": "Questions? Send us an email" },
    { "type": "text", "id": "heading", "label": "Heading", "default": "Send us an email" },

    { "type": "text", "id": "label_name", "label": "Label - Name", "default": "Name" },
    { "type": "text", "id": "label_email", "label": "Label - Email", "default": "Email" },
    { "type": "text", "id": "label_phone", "label": "Label - Phone", "default": "Phone number" },
    { "type": "text", "id": "label_message", "label": "Label - Message", "default": "Message" },

    { "type": "text", "id": "ph_name", "label": "Placeholder - Name", "default": "Your name" },
    { "type": "text", "id": "ph_email", "label": "Placeholder - Email", "default": "you@email.com" },
    { "type": "text", "id": "ph_phone", "label": "Placeholder - Phone", "default": "(+84) ..." },
    { "type": "text", "id": "ph_message", "label": "Placeholder - Message", "default": "How can we help?" },

    { "type": "text", "id": "button_text", "label": "Button text", "default": "Send" },
    { "type": "text", "id": "success_text", "label": "Success message", "default": "Thanks! We’ll get back to you soon." }
  ],
  "presets": [
    { "name": "Contact - Hero + Form" }
  ]
}
{% endschema %}
